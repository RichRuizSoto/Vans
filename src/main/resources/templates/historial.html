<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Historial de Compras - Vans</title>
    <link rel="stylesheet" href="/estilos.css">
</head>
<body>
<header>
    <nav class="navbar">
        <div class="logo">
            <img src="/img/logo-vans.png" alt="Vans Logo">
        </div>
        <ul class="nav-links">
            <li><a th:href="@{/}">Inicio</a></li>
            <li><a th:href="@{/catalogo}">Catálogo</a></li>
            <li><a th:href="@{/carrito}">Carrito</a></li>
            <li><a th:href="@{/historial}">Historial</a></li>
        </ul>
    </nav>
</header>

<main class="historial-container">
    <h2>Historial de Compras</h2>

    <form method="get" th:action="@{/historial}">
        <label for="usuarioId">Filtrar por Usuario:</label>
        <select name="usuarioId" id="usuarioId">
            <option value="">Ver todos</option>
            <option th:each="usuario : ${usuarios}"
                    th:value="${usuario.id}"
                    th:selected="${usuario.id == usuarioSeleccionado?.id}"
                    th:text="${usuario.nombre}"></option>
        </select>
        <button type="submit">Ver Historial</button>
    </form>

    <section class="tabla-historial">
        <table>
            <thead>
                <tr>
                    <th>#</th>
                    <th>Usuario</th>
                    <th>Fecha</th>
                    <th>Producto</th>
                    <th>Precio</th>
                    <th>Estado</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="item, iterStat : ${historial}">
                    <td th:text="${iterStat.index + 1}">1</td>
                    <td th:text="${item.usuario.nombre}">Usuario</td>
                    <td th:text="${#dates.format(item.fechaCompra, 'dd/MM/yyyy HH:mm')}">05/07/2025</td>
                    <td th:text="${item.producto.nombre}">Vans Old Skool</td>
                    <td th:text="${item.producto.precio}">$59.99</td>
                    <td th:text="${item.estado}">Confirmado</td>
                </tr>
                <tr th:if="${#lists.isEmpty(historial)}">
                    <td colspan="6" style="text-align: center;">No hay compras registradas aún.</td>
                </tr>
            </tbody>
        </table>
    </section>
</main>
</body>
</html>